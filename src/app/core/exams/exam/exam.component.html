<app-portal>
  <ng-container class="render">
    <div class="tabs">
      <ol class="tabs__links">
        <li data-revealId="create-exam" data-default="true" appTabView appPermitted [table]="'exam'" [operation]="'create'">Create</li>
        <li data-revealId="list-exam" appTabView (click)="getExams()">List</li>
      </ol>
      <div class="tabs__content">
        <div data-revealId="create-exam" appPermitted [table]="'exam'" [operation]="'create'">
          <form #form="ngForm" (ngSubmit)="addExam(form.value)" ngNativeValidate>
            <span>Create exam</span>
            <div class="input">
              <fieldset>
                <label for="name">Exam title</label>
                <input type="text" id="name" name="name" required ngModel autocomplete="off" pattern="[a-zA-Z0-9 ]{1,}">
              </fieldset>
            </div>
            <div class="inputs">
              <fieldset>
                <label for="startDate">Start date</label>
                <input type="date" id="startDate" name="startDate" ngModel required>
              </fieldset>
              <fieldset>
                <label for="endDate">End date</label>
                <input type="date" id="endDate" name="endDate" ngModel required>
              </fieldset>
            </div>
            <div class="inputs">
              <fieldset>
                <label for="term">Term</label>
                <select name="term" id="term" required ngModel>
                  <option value="1">Term I</option>
                  <option value="2">Term II</option>
                  <option value="3">Term III</option>
                </select>
              </fieldset>
              <fieldset>
                <label for="grading">Grading scheme</label>
                <select name="grading" id="grading" required ngModel>
                  <option [value]="grading.id" *ngFor="let grading of gradings">{{grading.label}}</option>
                </select>
              </fieldset>
            </div>
            <div class="submit">
              <fieldset>
                <button class="btn btn--blue" [disabled]="isSaving">Save Exam</button>
                <app-loader *ngIf="isSaving"></app-loader>
              </fieldset>
            </div>
          </form>
        </div>
        <div data-revealId="list-exam">
          <app-normal-pagination [total]="total" (options)="onOptionsChange($event)"
            [sorts]="['id','name','startDate','endDate','term','status']"></app-normal-pagination>
          <app-loader *ngIf="isGettingExams"></app-loader>
          <table *ngIf="!isGettingExams" class="not-mobile">
            <caption>List of exams</caption>
            <thead>
              <tr>
                <th>Title</th>
                <th>Start date</th>
                <th>End date</th>
                <th>Term</th>
                <th>Grading</th>
                <th>State</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let exam of exams" class="clickable" (click)="viewDetails(exam.id)">
                <td>{{exam.name}}</td>
                <td>{{exam.startDate | date}}</td>
                <td>{{exam.endDate | date}}</td>
                <td>{{exam.term}}</td>
                <td>{{exam.grading}}</td>
                <td>{{exam.status}}</td>
              </tr>
            </tbody>
          </table>
          <table *ngIf="!isGettingExams" class="mobile-only">
            <tbody>
              <tr *ngFor="let exam of exams" class="clickable" (click)="viewDetails(exam.id)">
                <div>
                  <span>Title</span>
                  <span>{{exam.name}}</span>
                </div>
                <div>
                  <span>Start</span>
                  <span>{{exam.startDate | date}}</span>
                </div>
                <div>
                  <span>End</span>
                  <span>{{exam.endDate | date}}</span>
                </div>
                <div>
                  <span>Term</span>
                  <span>{{exam.term}}</span>
                </div>
                <div>
                  <span>Grading</span>
                  <span>{{exam.grading}}</span>
                </div>
                <div>
                  <span>Status</span>
                  <span>{{exam.status}}</span>
                </div>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>
  </ng-container>
</app-portal>